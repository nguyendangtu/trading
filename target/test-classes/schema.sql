-- CREATE DATABASE  IF NOT EXISTS TEST;
-- USE TEST;

DROP TABLE IF EXISTS TRADE;
CREATE TABLE TRADE (
  TRADE_ID BIGINT NOT NULL,
  TRADE_VERSION INT NOT NULL,
  SECURITY_IDENTIFIER VARCHAR(3) DEFAULT NULL,
  QUANTITY INT ,
  DIRECTION CHAR DEFAULT NULL,
  ACCOUNT_NUMBER VARCHAR(30) DEFAULT NULL,
  OPERATION ENUM('NEW','AMEND','CANCEL'),
  PRIMARY KEY (TRADE_ID)
);

DROP TABLE IF EXISTS SECURITY_POSITION;
CREATE TABLE SECURITY_POSITION (
  ACCOUNT_NUMBER VARCHAR(30) DEFAULT NULL,
  INSTRUMENT VARCHAR(3) DEFAULT NULL,
  QUANTITY INT,
  PRIMARY KEY (ACCOUNT_NUMBER)
);

DROP TABLE IF EXISTS SECURITY_POSITION_TRADING_MAPPING;
CREATE TABLE SECURITY_POSITION_TRADING_MAPPING (
  ACCOUNT_NUMBER VARCHAR(30) NOT NULL,
  TRADE_ID BIGINT NOT NULL,
  PRIMARY KEY (ACCOUNT_NUMBER),
  CONSTRAINT FK_ACCOUNT_NUMBER FOREIGN KEY (ACCOUNT_NUMBER) REFERENCES SECURITY_POSITION (ACCOUNT_NUMBER)
);
